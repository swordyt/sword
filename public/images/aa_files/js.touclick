/* Copyright (c) 2012-2013 HANGZHOUWEICHUKEJI.Co.,Ltd. All rights reserved. TouClick-Type: Block2013.12.11*/(function () { var touclicks='n1-SRrFop17V-APxXb3n16v0TRYfJxGsB6ugGW-A34lQhl2L5yHf535wCSSULvaqYQN0Yrdt4J58Lu0Dy4hXWZTXrM62e2APa1kKyRMtxuXrzRleFnQjYtDhi706DfXXfX1UDl0VEypxNSY9cGQ0uXtHg';var touclick_isvip=1; var skinPath = "http://js.touclick.com/Configure/image/block/11-4/"; var tou_url = { requesturl: "http://request.touclick.com/captcharequest.touclick?", testurl: "http://test.touclick.com/captchatest.touclick?", iurl: function () { return "http://aly.touclick.com/i.touclick?b=" + Global.b } }; var skinobj = { skinName: "white", background_shade_color: "#000", text_color_note: '#333', text_color_text: '#069' }; var skinName = skinobj.skinName; var background_shade_color = skinobj.background_shade_color; var text_color_note = skinobj.text_color_note; var text_color_text = skinobj.text_color_text; var touclick_pic_path = skinPath + skinName; var touclick_hov_path = skinPath + skinName; if (window.ActiveXObject && navigator.userAgent.toLocaleLowerCase().match(/msie ([\d.]+)/)[1] == "6.0") { touclick_pic_path += '/ie6/1.gif'; touclick_hov_path += '/ie6/hov.gif' } else { touclick_pic_path += '/1.png'; touclick_hov_path += '/hov.png' }; var html = '<div id="touclick" class="touclick-pic" style="display:none;width:377px;height:308px;position:fixed;z-index:10000;font-size:0px;overflow:hidden;margin-left:-188px;margin-top:-154px;left:50%;top:50%;"><div id="touclick-div-par"></div><div class="touclick-font"><span class="touclick-font14 touclick-color-note">&#28857;&#35302;&#39564;&#35777;&#58;</span><span id="touclick-text-note"class="touclick-font16 touclick-color-note"></span><span id="touclick-text"class="touclick-font16 touclick-color-text"></span><span id="touclick-text-note1"class="touclick-font16 touclick-color-note">&#44;&#24182;&#25552;&#20132;</span></div><div style="overflow:hidden;"><div id="touclick-submit"class="touclick-pic touclick-submit-normal"></div><div id="touclick-reload"class="touclick-pic touclick-reload-normal"></div></div><a id="touclick-info-a" onclick="javascript:this.href+=\'&ran=\'+Math.floor(Math.random()*10000000);" href=""target="_blank"title="&#28857;&#35302;&#39564;&#35777;&#30721;"style="display:none"><div style="position:absolute;left:2px;top:275px;background-position:0px -471px;width:30px;height:30px;cursor:pointer;"class="touclick-pic"></div></a></div><style>.touclick-pic{background-image:url(' + touclick_pic_path + ')}#touclick-div-par{width:364px;height:172px;border:none;font-size:0px;margin:11px 6px 0px 7px}.touclick-div{width:80px;height:80px;margin:0px 6px 0px 5px;float:left;cursor:pointer;display:inline}.touclick-div img{float:left;border:0px;font-size:0px}.touclick-selpic{margin-left:-80px}#touclick-submit{width:195px;height:38px;cursor:pointer;float:left;margin-top:5.5px;margin-left:86px;margin-right:37px;display:inline}.touclick-submit-normal{background-position:0px -357px}.touclick-submit-normal:hover{background-position:0px -395px}.touclick-submit-click{background-position:0px -433px;cursor:pointer}#touclick-reload{width:47px;height:49px;cursor:pointer;float:left}.touclick-reload-normal{background-position:0px -308px}.touclick-reload-normal:hover{background-position:-47px -308px}.touclick-reload-click{background-position:-94px -308px;cursor:pointer}.touclick-font{clear:both;font-family:\'Microsoft YaHei\';cursor:default;text-align:center;height:60px;line-height:59px;color:' + text_color_note + '}.touclick-font14{font-size:14px;font-weight:bold}.touclick-font16{font-size:16px}.touclick-color-text{color:' + text_color_text + ';font-weight:bold}</style>'; var Change = { toLoading: function () { this.Action(0, 1, 0, '&#27491;&#22312;&#21152;&#36733;&#20013;') }, toVerify: function () { this.Action(0, 1, 0, '&#27491;&#22312;&#39564;&#35777;&#20013;') }, toImage: function () { this.Action(1, 1, 1, '&#28857;&#20987;&#25152;&#26377;&#30340;') }, toFail: function () { this.Action(0, 1, 0, '&#39564;&#35777;&#38169;&#35823;&#44;&#35831;&#37325;&#26032;&#39564;&#35777;') }, toSuccess: function () { this.Action(0, 1, 0, '&#39564;&#35777;&#25104;&#21151;&#44;&#36339;&#36716;&#20013;&#46;&#46;&#46;') }, toEmpty: function () { this.Action(0, 1, 0, '&#27809;&#26377;&#36873;&#25321;&#22270;&#29255;') }, Action: function (a, b, c, text) { Global.toutext.style.display = a ? 'inline' : 'none'; Global.toutextnote.style.display = b ? 'inline' : 'none'; Global.toutextnote1.style.display = c ? 'inline' : 'none'; Global.toutextnote.innerHTML = text } }; var AdFun = { removeLink: function () { var touclick_link = document.getElementById("touclick_link"); if (touclick_link) { Global.touclick.removeChild(touclick_link) } }, removeHover: function () { Global.hoverimg = this.createHoverImg(touclick_hov_path) }, removePic: function () { Global.adblocks = []; Global.unfulleight = true }, remove: function () { this.removeLink(); this.removeHover(); this.removePic() }, createHoverImg: function (src, width, height) { var img = document.createElement('img'); img.src = src; if (typeof (width) === 'number' && width >= 0) { img.width = width } else { img.width = 80 }; if (typeof (height) === 'number' && height >= 0) { img.height = height } else { img.height = 80 }; img.className = 'touclick-selpic'; return img } }; var Global = { isie6: false, touclick: null, parnode: null, reload: null, submit: null, toutextnote: null, toutextnote1: null, toutext: null, blockobj: null, b: '', c: "1", s: "", t: "1", i: "", Start: touStart, hoverimg: AdFun.createHoverImg(touclick_hov_path), lock: null, ErrorToLocal: null, success_fn: null, loading_fn: null, loaded_fn: null, fail_fn: null, submitting_fn: null, isTouch: false, adurl: null, adblocks: [], unfulleight: false }; var divFragment = document.createElement("div"); divFragment.innerHTML = html; var touclick_write_html_count = 0; function writehtml() { touclick_write_html_count++; if (document.readyState === 'complete' || touclick_write_html_count > 30) { while (divFragment.firstChild) { document.body.appendChild(divFragment.removeChild(divFragment.firstChild)) }; touInit() } else { setTimeout(writehtml, 100) } }; writehtml(); function touInit() { if (isEventSupported("touchstart") === true) { Global.isTouch = true }; Global.touclick = getObj('touclick'); Global.reload = getObj('touclick-reload'); Global.submit = getObj('touclick-submit'); Global.toutext = getObj('touclick-text'); Global.toutextnote = getObj('touclick-text-note'); Global.toutextnote1 = getObj('touclick-text-note1'); var useragent = navigator.userAgent.toLocaleLowerCase(); var ieagent = false; if (window.ActiveXObject && useragent.match(/msie ([\d.]+)/)[1] == "6.0") { Global.isie6 = true }; Global.lock = new lock(); addEvent(Global.reload, 'mousedown', reload('down')); addEvent(Global.submit, 'mousedown', submit('down')); addEvent(document, 'mouseup', function () { reload('up') }); addEvent(Global.reload, 'click', reload('click')); addEvent(Global.submit, 'click', submit('click')); var touclick_info = document.getElementById("touclick-info-a"); if (touclick_info && (typeof (touclick_isvip) === 'undefined' || !touclick_isvip)) { touclick_info.style.display = "block" }; if (window.TouClick && typeof (window.TouClick.onInit) === 'function') { window.TouClick.onInit() } }; function touStart(obj) { if (typeof (obj) != 'object') { obj = {} }; var website_key = obj.website_key; var position_code = obj.position_code; var init_fn = obj.onInit; var success_fn = obj.onSuccess; var error_fn = obj.onError; var fail_fn = obj.onFail; var loading_fn = obj.onLoading; var loaded_fn = obj.onLoaded; var close_fn = obj.onClose; var args = obj.args; var captcha_style = obj.captcha_style; var shadow = obj.shadow; var fn_arr = { 'success_fn': success_fn, 'loading_fn': loading_fn, 'loaded_fn': loaded_fn, 'fail_fn': fail_fn, submitting_fn: 'submitting_fn', 'close_fn': close_fn }; for (var fn_arr_item in fn_arr) { var fn = fn_arr[fn_arr_item]; if (typeof (fn) === 'function') { Global[fn_arr_item] = fn } else { Global[fn_arr_item] = function () { } } }; if (typeof (position_code) === 'number' && position_code < 100 && position_code > 10) { Global.c = position_code } else { Global.c = 0 }; if (typeof (args) === 'undefined') { Global.args = null } else { Global.args = args }; Global.ErrorToLocal = function () { close(); Global.touclick.innerHTML += "<div style='display:none;'>ErrorToLocal</div>"; if (typeof (error_fn) === 'function') { error_fn(Global.args) } }; if (typeof (website_key) === 'undefined' || !website_key) { Global.touclick.innerHTML += "<div style='display:none;'>PubKey is null</div>"; Global.ErrorToLocal(); return }; Global.b = website_key; if (Global.isie6 || Global.isTouch) { Global.touclick.style.position = "absolute"; var top = Math.max(document.documentElement.scrollTop, document.body.scrollTop) + document.documentElement.clientHeight / 2; top = top > 153 ? top : 153; Global.touclick.style.top = top + "px" }; if (typeof (shadow) !== 'boolean' || shadow === true) { Global.lock.show(Global.isie6) }; if (typeof (captcha_style) === 'object') { var style = Global.touclick.style; for (var style_item in captcha_style) { var lpos = style_item.indexOf('-'); var style_name; if (lpos > -1) { style_name = style_item.substring(0, lpos) + style_item.charAt(lpos + 1).toUpperCase(); if (style_item.length > lpos + 1) { style_name += style_item.substring(lpos + 2, style_item.length) } } else { style_name = style_item }; style[style_name] = captcha_style[style_item] } }; if (typeof (init_fn) === 'function') { init_fn(args) }; Global.blockobj = new BlockClass(); if (website_key.length != 36) { Change.toTiping() } else { reload() }; Global.touclick.style.display = "block"; document.getElementById("touclick-info-a").href = tou_url.iurl() }; function reload(action) { if (action === 'down') { return function () { Global.reload.className = 'touclick-pic touclick-reload-click' } } else if (action === 'up') { Global.reload.className = 'touclick-pic touclick-reload-normal' } else if (action === 'click') { return function () { Change.toLoading(); Global.loading_fn(Global.args); touclick_jsonp("js=" + touclicks + "&b=" + Global.b + "&c=" + Global.c + "&t=" + Global.t + "&s=" + Global.s, "getAjax") } } else { reload('click')() } }; function submit(action) { if (action === 'down') { return function () { Global.submit.className = 'touclick-pic touclick-submit-click' } } else if (action === 'click') { return function () { var res = Global.blockobj.getres(); if (res === '') { Change.toEmpty(); Global.submit.className = 'touclick-pic touclick-submit-normal'; setTimeout(Change.toImage, 800); return }; Change.toVerify(); Global.submitting_fn(Global.args); touclick_jsonp("js=" + touclicks + "&b=" + Global.b + "&c=" + Global.c + "&s=" + Global.s + "&r=" + res, "Test"); if (typeof (Global.ad_onPicLoad) === 'function') { Global.ad_onPicLoad() } } } else { submit('click')() } };function Callback(p, n, t, UrlAd, c, ts, e, i, ser, ad_obj) { var c_temp = []; c_temp = c.split(""); Global.captchatype = c_temp[1]; c = c_temp[0]; if (c == "1") { Global.i = i; Global.s = ts; Global.toutext.innerHTML = arrtotext(t); Change.toImage(); if (typeof (ad_obj) === 'object' && ad_obj !== null) { if (typeof (ad_obj.link) === 'object' && ad_obj.link !== null) { var link = ad_obj.link; if (typeof (link.src) === 'string' && link.src !== '' && typeof (link.left) === 'number' && typeof (link.top) === 'number' && typeof (link.href) === 'string') { var touclick_link = document.getElementById("touclick_link"); var linkcss = "<a  onclick=\"javascript:this.href+='&ran='+Math.floor(Math.random()*10000000);\"  id='touclick_link' target='_blank'><img id='touclick-link-img'/><style>#touclick_link{position:absolute;display:inline}#touclick_link:hover{opacity:0.7;filter:alpha(opacity=70);}#touclick-link-img{border:none;}</style></a>"; if (touclick_link) { Global.touclick.removeChild(touclick_link) }; var divfram = document.createElement('div'); divfram.innerHTML = linkcss; while (divfram.firstChild) { Global.touclick.appendChild(divfram.removeChild(divfram.firstChild)) }; touclick_link = document.getElementById("touclick_link"); var touclick_link_img = document.getElementById("touclick-link-img"); touclick_link.href = link.href; touclick_link.style.left = link.left + 'px'; touclick_link.style.top = link.top + 'px'; touclick_link_img.src = link.src } else { AdFun.removeLink() } } else { AdFun.removeLink() }; if (typeof (ad_obj.hover) === 'object' && ad_obj.hover !== null) { var hover = ad_obj.hover; if (typeof (hover.src) === 'string' && hover.src !== '') { Global.hoverimg = AdFun.createHoverImg(hover.src, hover.width, hover.height) } else { AdFun.removeHover() } } else { AdFun.removeHover() }; if (typeof (ad_obj.adpic) === 'object' && ad_obj.adpic !== null) { var adpic = ad_obj.adpic; if (typeof (adpic.html) !== 'undefined' && adpic.html !== null) { for (var key in adpic.html) { Global.adblocks[key] = adpic.html[key]; Global.unfulleight = false } } else { AdFun.removePic() }; if (typeof (adpic.script) !== 'undefined') { try { eval(adpic.script) } catch (e) { } } } else { AdFun.removePic() } } else { AdFun.remove() }; Global.blockobj.reload(p) } else if (c == "3") { Global.submit.className = 'touclick-pic touclick-submit-normal'; Global.s = ts; Change.toFail(); setTimeout(reload, 1000); Global.fail_fn(Global.args) } else if (c == "2") { Global.submit.className = 'touclick-pic touclick-submit-normal'; Global.s = ts; Change.toSuccess(); Global.lock.close(); Global.success_fn(Global.args, { check_key: Global.i, check_address: ser }); var time = 1700; if (typeof (close_time) === 'number') { time = close_time }; setTimeout(close, time) } else { Global.ErrorToLocal() } }; function BlockClass() { var parnode = getObj('touclick-div-par'); var ie6_content; var ie6_i = 0; this.reload = function (content) { removeChild(parnode); var length = content.length; if (length < 8 && Global.unfulleight === true) { for (var i = length; i < 8; i++) { content[i] = { Entity: touclick_hov_path, Name: '' } }; length = 8 }; for (var i = 0; i < length; i++) { addBlock(i, content) } }; function addBlock(i, content) { if (typeof (Global.adblocks[i]) !== 'undefined') { var divfram = document.createElement('div'); divfram.innerHTML = Global.adblocks[i]; while (divfram.firstChild) { var node = divfram.removeChild(divfram.firstChild); parnode.appendChild(node) } }; var picdiv = document.createElement("div"); picdiv.onclick = picclick; picdiv.setAttribute("tou", content[i].Name); if (i >= content.length / 2) { picdiv.className += "touclick-div"; picdiv.style.marginTop = '12px' } else { picdiv.className = "touclick-div" }; var pic = document.createElement("img"); pic.src = restore(content[i].Entity); pic.width = 80; pic.height = 80; picdiv.appendChild(pic); parnode.appendChild(picdiv) }; function picclick(e) { stopDefault(e); if (this.className.indexOf("selectdiv") === -1) { this.className += " selectdiv"; var img = Global.hoverimg.cloneNode(true); this.appendChild(img) } else { this.className = "touclick-div"; this.removeChild(this.lastChild) } }; this.getres = function () { var r = ""; var nodes = parnode.children; var nodes_length = nodes.length; for (var i = 0; i < nodes_length; i++) { if (nodes[i].className.indexOf("selectdiv") != -1) { r += nodes[i].getAttribute("tou") + "," } }; return r }; function restore(b64) { if (typeof (b64) != "object") { return b64 }; for (var i = 0; i < b64.countA; i++) { b64.baseStr += 'A' }; for (var i = 0; i < b64.countEqual; i++) { b64.baseStr += '=' }; return 'data:image/jpg;base64,' + b64.baseStr }; function removeChild(dom) { try { while (dom.firstChild) { dom.removeChild(dom.firstChild) } } catch (e) { } } }; function arrtotext(t) { var res = ""; for (var i = 0; i < t.length; i++) { res += "\"" + t[i] + "\"" }; return res }; function touclick_jsonp(query, type) { var head = document.getElementsByTagName("head")[0]; var js = document.createElement("script"); var ran = Math.random(); if (type == "getAjax" && query != "" && query != null) { if (typeof (touclick_clientname) != 'undefined' && typeof (touclick_clientid) != 'undefined') { js.src = tou_url.requesturl + query + "&un=" + escape(touclick_clientname) + "&ud=" + escape(touclick_clientid) + "&ran=" + ran } else { js.src = tou_url.requesturl + query + "&ran=" + ran }; if (typeof (block_pic_number) != 'number') { block_pic_number = 8 }; js.src += "&n=" + block_pic_number; block_pic_number = null } else if (type == "Test" && query != "" && query != null) { if (typeof (touclick_clientname) != 'undefined' && typeof (touclick_clientid) != 'undefined') { js.src = tou_url.testurl + query + "&un=" + escape(touclick_clientname) + "&ud=" + escape(touclick_clientid) + "&ran=" + ran } else { js.src = tou_url.testurl + query + "&ran=" + ran } }; js.onload = js.onreadystatechange = function () { if (!this.readyState || this.readyState == "loaded" || this.readyState == "complete") { head.removeChild(js) } }; head.appendChild(js) }; function isEventSupported(eventName, element) { var TAGNAMES = { 'select': 'input', 'change': 'input', 'submit': 'form', 'reset': 'form', 'error': 'img', 'load': 'img', 'abort': 'img' }; element = element || document.createElement(TAGNAMES[eventName] || 'div'); eventName = 'on' + eventName; var isSupported = (eventName in element); if (!isSupported) { if (!element.setAttribute) { element = document.createElement('div') }; if (element.setAttribute && element.removeAttribute) { element.setAttribute(eventName, ''); isSupported = typeof element[eventName] == 'function'; if (typeof element[eventName] != 'undefined') { element[eventName] = void 0 }; element.removeAttribute(eventName) } }; element = null; return isSupported }; function lock() { var div_dom = null; this.show = function (isie6) { div_dom.style.display = 'block'; if (isie6 === true) { var style = div_dom.style; style.position = 'absolute'; var height = Math.max(document.documentElement.clientHeight, document.body.clientHeight); style.height = height + 'px' } }; this.close = function () { div_dom.style.display = 'none' }; div_dom = document.createElement("div"); var style = div_dom.style; style.display = "none"; style.position = "fixed"; style.left = "0px"; style.top = "0px"; style.zIndex = "9999"; style.height = style.width = "100%"; var back_shade_color = '#000'; if (typeof (background_shade_color) != 'undefined') { back_shade_color = background_shade_color }; style.backgroundColor = back_shade_color; addEvent(div_dom, 'click', close); style.opacity = "0.5"; style.filter = "alpha(opacity=50)"; function appendtobody() { if (document.readyState == 'complete') { document.body.appendChild(div_dom) } else { setTimeout(appendtobody, 50) } }; appendtobody() }; function close() { Global.lock.close(); Global.touclick.style.display = "none"; Global.close_fn() }; function stopDefault(e) { if (e && e.preventDefault) { e.preventDefault() } else { window.event.returnValue = false }; return false }; function getObj(id) { return document.getElementById(id) }; function addEvent(obj, eventName, fn) { if (obj.addEventListener) { obj.addEventListener(eventName, fn, false) } else { obj.attachEvent("on" + eventName, fn) } }; function removeEvent(obj, eventName, fn) { if (obj.removeEventListener) { obj.removeEventListener(eventName, fn, false) } else if (obj.detachEvent) { obj.detachEvent("on" + eventName, fn) } else { obj["on" + eventName] = null } }; var touclick = window['TouClick'] || {}; touclick.Start = Global.Start; touclick.Callback = Callback; touclick.Close = close; touclick.closeshadow = function () { Global.lock.close() }; window['TouClick'] = touclick })(); var TouclickCallback = TouClick.Callback;